{% extends 'base.html' %}
{% block content %}

<h2 class="mb-4">{{ yemek.ad }}</h2>

<div class="row">
    <div class="col-md-6">
        {% if yemek.foto %}
            <img src="{{ yemek.foto }}" class="img-fluid rounded shadow-sm" alt="Yemek Foto">
        {% else %}
            <div class="bg-light d-flex align-items-center justify-content-center rounded shadow-sm" style="height: 350px;">
                <p class="text-muted">Fotoğraf Yok</p>
            </div>
        {% endif %}
        
        <div class="mt-3">
            {% if session.logged_in %}
                <a href="{{ url_for('duzenle', id=yemek.id) }}" class="btn btn-warning me-2">Düzenle</a>
                <a href="{{ url_for('sil', id=yemek.id) }}" class="btn btn-danger"
                    onclick="return confirm('Bu yemeği silmek istiyor musun?');">
                    Sil
                </a>
            {% endif %}
        </div>
    </div>

    <div class="col-md-6">
        <p class="mt-3">{{ yemek.aciklama }}</p>

        <hr>

        <h5>Yorumlar ({{ yemek.yorumlar | length }})</h5>
        {% for yorum in yemek.yorumlar|reverse %}
            <div class="alert alert-secondary py-2">
                {{ yorum.yorum }}
                <br>
                <small class="text-muted">{{ yorum.tarih.strftime('%d.%m.%Y %H:%M') }}</small>
            </div>
        {% endfor %}
        
        {% if not yemek.yorumlar %}
            <p class="text-muted">Henüz yorum yapılmamış.</p>
        {% endif %}

        <hr>

        <h5>Yeni Yorum Ekle</h5>
        <form method="POST" action="{{ url_for('yorum_ekle', id=yemek.id) }}">
            <textarea name="yorum" class="form-control mb-2" rows="3" placeholder="Yorum yaz..." required></textarea>
            <button class="btn btn-success">Gönder</button>
        </form>
    </div>
</div>

{% endblock %}